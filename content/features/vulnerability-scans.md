---
title: 'Vulnerability Scans'
description: 'Run scheduled Trivy scans across all Docker images and review results in Arcane.'
---

<script lang="ts">
import ScreenshotFrame from '$lib/components/screenshot-frame.svelte';
</script>

Arcane can run scheduled vulnerability scans against all Docker images using Trivy. Scans are opt-in and run on a cron schedule. Results are stored for each image and surfaced in the UI.

## Screenshot

<ScreenshotFrame
  src="/img/screenshots/vulnerabilities.png"
  alt="Vulnerability scans view in Arcane"
  caption="Vulnerability scans in Arcane."
  loading="lazy"
  decoding="async"
/>

## How It Works

1. The scheduler checks the `vulnerabilityScanEnabled` setting. If disabled, the run is skipped.
2. A Trivy image is ensured locally (default `ghcr.io/aquasecurity/trivy:latest`, or the `TrivyImage` setting override).
3. A single long-running Trivy container is started for the batch.
4. Each image is scanned via `docker exec` into that container.
5. Results and metadata are saved per image, including severity counts and scan duration.

## Scheduling

The scan interval is configured via `vulnerabilityScanInterval`. It uses a 6-field cron format (with seconds). Default: `0 0 0 * * *` (daily at midnight).

If the interval changes, the running scheduler reschedules the job without a restart.

## Settings

These settings control the feature:

- `vulnerabilityScanEnabled`: Enables or disables scheduled scans.
- `vulnerabilityScanInterval`: Cron expression for the schedule.
- `TrivyImage`: Optional override for the Trivy image reference.

## Notes

- Scans skip unnamed or dangling images.
- Trivy config and ignore files are supported through settings and are mounted into the scan container.
- Cleanup removes stale scan records for images that no longer exist.
